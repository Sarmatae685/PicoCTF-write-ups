from Crypto.Util.number import long_to_bytes

n = 118694899393140300601438740810023181785746678905636582269360228605676719905088478361579988897743669122497659396273025097384493060342878497211729885217100072793914813864687346435180260223348630366934210538562839722090611275026677540192918386503692952364711612240191829507331576540266094372559167055187119947693
e = 65537
ciphertext = 20975483160078067146389226204502717295542528615500244902685475409984670320790256508621556322795196433894895894785551238549196424496432527017825371115820528130458724982379618139870867225278424798793453333650916921402218612961924138465621433836534545044090208880818006463081880001842285620493807796825903216257

message = pow(2, e, n)

multiply_ciphertext_and_message = (ciphertext * message) % n
print(f"Product of ciphertext * message: {multiply_ciphertext_and_message}")

decrypted_multiplication_by_server = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890768853279675297196794

original_message = decrypted_multiplication_by_server // 2

try:
    flag = long_to_bytes(original_message).decode('ascii')
    print(f"Flag: {flag}")
except:
    print("Unable to decode original_message as ASCII")
    print("Showing bytes: ")
    print(long_to_bytes(original_message))
